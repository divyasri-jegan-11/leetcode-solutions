
# 577. Employee Bonus

## ðŸ“ Problem Statement

Write a solution to report the name and bonus amount of each employee with a bonus **less than** `1000`.

Return the result table sorted in **any order.**


### Table:  `Employee`

| Column Name | Type    |
|-------------|---------|
| empId       | int     |
| name        | varchar |
| supervisor  | int     |
| salary      | int     |

 - empId is the column with unique values for this table.
 - Each row of this table indicates the name and the ID of an employee in addition to their salary and the id of their manager.
   
### Table: `Bonus`

+-------------+------+
| Column Name | Type |
+-------------+------+
| empId       | int  |
| bonus       | int  |
+-------------+------+
empId is the column of unique values for this table.
empId is a foreign key (reference column) to empId from the Employee table.
Each row of this table contains the id of an employee and their respective bonus.
 
## ðŸ“¥ Example Input

Employee table:

| id  | name  | department | managerId |
|-----|-------|------------|-----------|
| 101 | John  | A          | null      |
| 102 | Dan   | A          | 101       |
| 103 | James | A          | 101       |
| 104 | Amy   | A          | 101       |
| 105 | Anne  | A          | 101       |
| 106 | Ron   | B          | 101       |

Output: 

| name |
|------|
| John |


## ðŸ’¡ SQL Solution

```sql


SELECT name FROM Employee WHERE id IN (
    SELECT managerId FROM Employee
    WHERE managerId IS NOT NULL
    GROUP BY managerId 
    HAVING COUNT(*)>=5
);
SELECT e.name,b.bonus FROM Employee e 
LEFT JOIN Bonus b ON e.empId = b.empId 
WHERE b.bonus IS NULL OR b.bonus<1000;
