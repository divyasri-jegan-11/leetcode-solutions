
# 1633. Percentage of Users Attended a Contest

## üìù Problem Statement

### Table: `Users`

| Column Name | Type    |
|-------------|---------|
| user_id     | int     |
| user_name   | varchar |

 - user_id is the primary key (column with unique values) for this table.
 - Each row of this table contains the name and the id of a user.
 

### Table: `Register`

| Column Name | Type    |
|-------------|---------|
| contest_id  | int     |
| user_id     | int     |

 - (contest_id, user_id) is the primary key (combination of columns with unique values) for this table.
 - Each row of this table contains the id of a user and the contest they registered into.
 

Write a solution to find the percentage of the users registered in each contest rounded to two decimals.

Return the result table ordered by `percentage` in **descending order**. In case of a tie, order it by `contest_id` in **ascending order**.

### Table: `UnitsSold`

| Column Name   | Type    |
|---------------|---------|
| product_id    | int     |
| purchase_date | date    |
| units         | int     |

 - This table may contain duplicate rows.
 - Each row of this table indicates the date, units, and product_id of each product sold. 
 
Write a solution to find the average selling price for each product. `average_price `should be rounded to 2 decimal places. If a product does not have any sold units, its average selling price is assumed to be 0.

Return the result table in **any order**.

---

## üì• Example Input

Input : Prices 

| product_id | start_date | end_date   | price  |
|------------|------------|------------|--------|
| 1          | 2019-02-17 | 2019-02-28 | 5      |
| 1          | 2019-03-01 | 2019-03-22 | 20     |
| 2          | 2019-02-01 | 2019-02-20 | 15     |
| 2          | 2019-02-21 | 2019-03-31 | 30     |

UnitsSold table:

| product_id | purchase_date | units |
|------------|---------------|-------|
| 1          | 2019-02-25    | 100   |
| 1          | 2019-03-01    | 15    |
| 2          | 2019-02-10    | 200   |
| 2          | 2019-03-22    | 30    |


Output: 

| product_id | average_price |
|------------|---------------|
| 1          | 6.96          |
| 2          | 16.96         |


Explanation: 
 - Average selling price = Total Price of Product / Number of products sold.
 - Average selling price for product 1 = ((100 * 5) + (15 * 20)) / 115 = 6.96
 - Average selling price for product 2 = ((200 * 15) + (30 * 30)) / 230 = 16.96

## üí° SQL Solution

```sql

SELECT  p.product_id ,
        IFNULL(ROUND(SUM(u.units * p.price) /SUM(u.units),2),0) AS average_price
FROM  Prices p LEFT JOIN UnitsSold u
ON p.product_id = u.product_id
AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY p.product_id;
SELECT r.contest_id , ROUND(COUNT(DISTINCT r.user_id)*100.0 / (SELECT COUNT(*) FROM Users),2) AS percentage
 FROM  Register r GROUP BY r.contest_id
 ORDER BY percentage DESC, contest_id ASC;
