
# 1633. Percentage of Users Attended a Contest

## üìù Problem Statement

### Table: `Users`

| Column Name | Type    |
|-------------|---------|
| user_id     | int     |
| user_name   | varchar |

 - user_id is the primary key (column with unique values) for this table.
 - Each row of this table contains the name and the id of a user.
 

### Table: `Register`

| Column Name | Type    |
|-------------|---------|
| contest_id  | int     |
| user_id     | int     |

 - (contest_id, user_id) is the primary key (combination of columns with unique values) for this table.
 - Each row of this table contains the id of a user and the contest they registered into.
 

Write a solution to find the percentage of the users registered in each contest rounded to two decimals.

Return the result table ordered by `percentage` in **descending order**. In case of a tie, order it by `contest_id` in **ascending order**.

### Table: `UnitsSold`

| Column Name   | Type    |
|---------------|---------|
| product_id    | int     |
| purchase_date | date    |
| units         | int     |

 - This table may contain duplicate rows.
 - Each row of this table indicates the date, units, and product_id of each product sold. 
 
Write a solution to find the average selling price for each product. `average_price `should be rounded to 2 decimal places. If a product does not have any sold units, its average selling price is assumed to be 0.

Return the result table in **any order**.

---

## üì• Example Input

Input: 
Users table:

| user_id | user_name |
|---------|-----------|
| 6       | Alice     |
| 2       | Bob       |
| 7       | Alex      |

Register table:

| contest_id | user_id |
|------------|---------|
| 215        | 6       |
| 209        | 2       |
| 208        | 2       |
| 210        | 6       |
| 208        | 6       |
| 209        | 7       |
| 209        | 6       |
| 215        | 7       |
| 208        | 7       |
| 210        | 2       |
| 207        | 2       |
| 210        | 7       |

Output: 

| contest_id | percentage |
|------------|------------|
| 208        | 100.0      |
| 209        | 100.0      |
| 210        | 100.0      |
| 215        | 66.67      |
| 207        | 33.33      |

Explanation: 
 - All the users registered in contests 208, 209, and 210. The percentage is 100% and we sort them in the answer table by contest_id in ascending order.
 - Alice and Alex registered in contest 215 and the percentage is ((2/3) * 100) = 66.67%
 - Bob registered in contest 207 and the percentage is ((1/3) * 100) = 33.33%

## üí° SQL Solution

```sql

SELECT  p.product_id ,
        IFNULL(ROUND(SUM(u.units * p.price) /SUM(u.units),2),0) AS average_price
FROM  Prices p LEFT JOIN UnitsSold u
ON p.product_id = u.product_id
AND u.purchase_date BETWEEN p.start_date AND p.end_date
GROUP BY p.product_id;
SELECT r.contest_id , ROUND(COUNT(DISTINCT r.user_id)*100.0 / (SELECT COUNT(*) FROM Users),2) AS percentage
 FROM  Register r GROUP BY r.contest_id
 ORDER BY percentage DESC, contest_id ASC;
