# 1141. User Activity for the Past 30 Days I

## üìù Problem Statement

### Table: `Activity`


| Column Name   | Type    |
|---------------|---------|
| user_id       | int     |
| session_id    | int     |
| activity_date | date    |
| activity_type | enum    |

 - This table may have duplicate rows.
 - The activity_type column is an ENUM (category) of type ('open_session', 'end_session', 'scroll_down', 'send_message').
 - The table shows the user activities for a social media website. 
Note that each session belongs to exactly one user.
 

Write a solution to find the daily active user count for a period of `30` days ending `2019-07-27` inclusively. A user was active on someday if they made at least one activity on that day.

Return the result table in any order.

The result format is in the following example.

 

 # Example Input:
Input: 
Sales table:

| sale_id | product_id | year | quantity | price |
|---------|------------|------|----------|-------|
| 1       | 100        | 2008 | 10       | 5000  |
| 2       | 100        | 2009 | 12       | 5000  |
| 7       | 200        | 2011 | 15       | 9000  |


Output: 

| product_id | first_year | quantity | price |
|------------|------------|----------|-------|
| 100        | 2008       | 10       | 5000  |
| 200        | 2011       | 15       | 9000  |



## üí° SQL Solution

```sql


SELECT s.product_id, s.year AS first_year, s.quantity,s.price 
FROM Sales s 
JOIN (
     SELECT product_id,MIN(year) AS first_year
     FROM Sales
     GROUP BY product_id
      ) AS first_sales
 ON s.product_id = first_sales.product_id AND  s.year= first_year ;

SELECT activity_date AS day ,
   COUNT(DISTINCT user_id) AS active_users
FROM Activity 
WHERE activity_date BETWEEN '2019-06-28' AND '2019-07-27'
GROUP BY 1; 
