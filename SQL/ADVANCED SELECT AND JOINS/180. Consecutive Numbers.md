# 180. Consecutive Numbers

## üìù Problem Statement

### Table: `Logs`

| Column Name | Type    |
|-------------|---------|
| id          | int     |
| num         | varchar |

 - In SQL, id is the primary key for this table.
 - id is an autoincrement column starting from 1.
 

Find all numbers that appear at least three times consecutively.

Return the result table in any order.
 

### Example Input:

Input:  
Employees table:

Employee table:

| employee_id | department_id | primary_flag |
|-------------|---------------|--------------|
| 1           | 1             | N            |
| 2           | 1             | Y            |
| 2           | 2             | N            |
| 3           | 3             | N            |
| 4           | 2             | N            |
| 4           | 3             | Y            |
| 4           | 4             | N            |

Output: 

| employee_id | department_id |
|-------------|---------------|
| 1           | 1             |
| 2           | 1             |
| 3           | 3             |
| 4           | 3             |

Explanation: 
- The Primary department for employee 1 is 1.
- The Primary department for employee 2 is 1.
- The Primary department for employee 3 is 3.
- The Primary department for employee 4 is 3.

## üí° SQL Solution

```sql

SELECT employee_id, department_id FROM Employee
WHERE primary_flag = 'Y'
UNION DISTINCT
SELECT employee_id, department_id FROM Employee
GROUP BY 1
HAVING COUNT(*) = 1;

WITH LogsNeighbors AS (
    SELECT *,
          LAG(num) OVER(ORDER BY id ) AS prev_num,
          LEAD(num) OVER(ORDER BY id) AS next_num
    FROM Logs
 )
 SELECT DISTINCT num AS ConsecutiveNums
 FROM LogsNeighbors
 WHERE num = prev_num AND num = next_num; 
